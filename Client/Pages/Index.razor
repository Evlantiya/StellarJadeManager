@page "/"
@using StellarJadeManager.Client.Components.MainPage
@inject HttpClient Http

<Calendar patches="patches"></Calendar>



@code{
    [CascadingParameter]
    List<Profile> profiles { get; set; }
    

    public Dictionary<int, double> chances = new();
    public List<PatchDTO> patches;
    

    protected override async Task OnInitializedAsync(){
        //симуляция сервака с мл, коэфы регрессии
        var const_a = 3623.0/850; 
        var b = -497.0/8500;
        for (int roll_num = 1;roll_num <= 90; roll_num++){
            if(roll_num == 90){
                chances.Add(roll_num, 1);
            }
            else if(roll_num < 74){
                chances.Add(roll_num, 0.006);
            }
            else{
                chances.Add(roll_num, b*roll_num + const_a);
            }
        }   
        patches = await Http.GetFromJsonAsync<List<PatchDTO>>("/api/patches") ?? new();
        StateHasChanged();

    }
 }